"use strict";
(self["webpackChunk_mattermost_webapp"] = self["webpackChunk_mattermost_webapp"] || []).push([[355],{

/***/ 81093:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(45697);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(39714);
/* harmony import */ var core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(67294);


// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.
// See LICENSE.txt for license information.

/* eslint-disable max-lines */


const Svg = props => {
  var _props$width, _props$height;

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("svg", {
    width: ((_props$width = props.width) === null || _props$width === void 0 ? void 0 : _props$width.toString()) || '246',
    height: ((_props$height = props.height) === null || _props$height === void 0 ? void 0 : _props$height.toString()) || '182',
    viewBox: "0 0 246 182",
    fill: "none",
    xmlns: "http://www.w3.org/2000/svg"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("path", {
    d: "M22.7549 148.149H223.245C224.72 148.128 226.127 147.512 227.158 146.436C228.189 145.359 228.759 143.911 228.744 142.407V5.84874C228.759 4.34474 228.189 2.89609 227.158 1.81987C226.127 0.743655 224.72 0.127555 223.245 0.106445H22.7549C21.2803 0.12965 19.8745 0.746388 18.8443 1.82215C17.814 2.89791 17.243 4.34537 17.2556 5.84874V142.415C17.245 143.917 17.817 145.362 18.8471 146.436C19.8771 147.51 21.2817 148.126 22.7549 148.149Z",
    fill: "var(--center-channel-color)"
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("path", {
    d: "M0.638184 167.787C0.638184 174.585 6.16258 181.383 12.8629 181.383H233.145C239.458 181.383 245.362 174.601 245.362 167.787H0.638184Z",
    fill: "#24262E"
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("path", {
    d: "M224.969 148.149H21.0311L0.638184 167.787H245.362L224.969 148.149Z",
    fill: "#D1D4DB"
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("path", {
    d: "M218.87 149.66H27.1217L20.2764 157.968H225.723L218.87 149.66Z",
    fill: "#AFB3C0"
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("path", {
    d: "M144.023 160.989H101.985L98.8296 165.521H147.17L144.023 160.989Z",
    fill: "#24262E"
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("rect", {
    width: "187.319",
    height: "120.851",
    transform: "translate(29.3403 12.9468)",
    fill: "#505667"
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("path", {
    d: "M88.8224 110.383C84.491 110.383 82.5285 107.261 84.4612 103.445L119.469 34.6773C121.452 30.8712 124.574 30.8712 126.516 34.6773L161.515 103.445C163.497 107.251 161.515 110.383 157.154 110.383H88.8224Z",
    fill: "var(--away-indicator)"
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("path", {
    d: "M117.497 60.1105L121.095 84.2851C121.13 84.7648 121.345 85.2136 121.697 85.5412C122.049 85.8688 122.512 86.0509 122.993 86.0509C123.474 86.0509 123.937 85.8688 124.289 85.5412C124.642 85.2136 124.857 84.7648 124.891 84.2851L128.489 60.1105C129.143 50.6845 116.833 50.6845 117.497 60.1105Z",
    fill: "#2D3039"
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("path", {
    d: "M122.988 88.6563C124.078 88.6582 125.142 88.9831 126.047 89.5898C126.952 90.1966 127.657 91.0579 128.072 92.0651C128.488 93.0722 128.596 94.18 128.382 95.2483C128.168 96.3167 127.643 97.2977 126.871 98.0674C126.1 98.8372 125.118 99.361 124.05 99.5729C122.981 99.7847 121.873 99.675 120.867 99.2576C119.861 98.8402 119 98.1339 118.395 97.2278C117.79 96.3218 117.467 95.2567 117.467 94.1672C117.467 93.4426 117.61 92.7252 117.888 92.0559C118.165 91.3867 118.572 90.7787 119.085 90.2668C119.598 89.755 120.206 89.3493 120.876 89.0729C121.546 88.7965 122.264 88.655 122.988 88.6563Z",
    fill: "#2D3039"
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("path", {
    d: "M123 3.88281C123.597 3.88281 124.181 4.06002 124.678 4.392C125.175 4.72398 125.562 5.19583 125.791 5.7479C126.02 6.29996 126.08 6.90744 125.963 7.49351C125.846 8.07958 125.559 8.61792 125.136 9.04045C124.714 9.46299 124.175 9.75075 123.589 9.86732C123.003 9.9839 122.396 9.92404 121.844 9.69537C121.292 9.46669 120.82 9.07947 120.488 8.58263C120.156 8.08578 119.979 7.50164 119.979 6.90409C119.979 6.1028 120.297 5.33432 120.863 4.76772C121.43 4.20112 122.199 3.88281 123 3.88281Z",
    fill: "#DDDFE4"
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("path", {
    d: "M140.405 176.851H104.815C103.587 176.851 100.34 176.851 100.34 172.319H144.904C144.904 176.851 141.562 176.851 140.405 176.851Z",
    fill: "var(--center-channel-color)"
  }));
};

Svg.propTypes = {
  width: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().number),
  height: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().number)
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Svg);

/***/ }),

/***/ 29355:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(74916);
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_string_search_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(64765);
/* harmony import */ var core_js_modules_es_string_search_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_search_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(33948);
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var core_js_modules_web_url_search_params_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(41637);
/* harmony import */ var core_js_modules_web_url_search_params_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_url_search_params_js__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var core_js_modules_es_promise_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(88674);
/* harmony import */ var core_js_modules_es_promise_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_promise_js__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(15306);
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(67294);
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(86896);
/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(14494);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(5977);
/* harmony import */ var actions_global_actions__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(34288);
/* harmony import */ var actions_telemetry_actions_jsx__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(59925);
/* harmony import */ var components_common_svg_images_components_laptop_alert_svg__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(81093);
/* harmony import */ var components_header_footer_route_content_layouts_column__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(71284);
/* harmony import */ var components_loading_screen__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(19476);
/* harmony import */ var mattermost_redux_actions_errors__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(10386);
/* harmony import */ var mattermost_redux_actions_users__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(33383);
/* harmony import */ var mattermost_redux_selectors_entities_preferences__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(89754);
/* harmony import */ var mattermost_redux_selectors_entities_users__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(12707);
/* harmony import */ var utils_constants__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(66788);






// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.
// See LICENSE.txt for license information.















var VerifyStatus;

(function (VerifyStatus) {
  VerifyStatus["PENDING"] = "pending";
  VerifyStatus["SUCCESS"] = "success";
  VerifyStatus["FAILURE"] = "failure";
})(VerifyStatus || (VerifyStatus = {}));

const DoVerifyEmail = () => {
  var _params$get;

  const {
    formatMessage
  } = (0,react_intl__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)();
  const dispatch = (0,react_redux__WEBPACK_IMPORTED_MODULE_7__.useDispatch)();
  const history = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_19__/* .useHistory */ .k6)();
  const {
    search
  } = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_19__/* .useLocation */ .TH)();
  const params = new URLSearchParams(search);
  const token = (_params$get = params.get('token')) !== null && _params$get !== void 0 ? _params$get : '';
  const loggedIn = Boolean((0,react_redux__WEBPACK_IMPORTED_MODULE_7__.useSelector)(mattermost_redux_selectors_entities_users__WEBPACK_IMPORTED_MODULE_16__/* .getCurrentUserId */ .rc));
  const useCaseOnboarding = (0,react_redux__WEBPACK_IMPORTED_MODULE_7__.useSelector)(mattermost_redux_selectors_entities_preferences__WEBPACK_IMPORTED_MODULE_15__/* .getUseCaseOnboarding */ .NC);
  const [verifyStatus, setVerifyStatus] = (0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(VerifyStatus.PENDING);
  const [serverError, setServerError] = (0,react__WEBPACK_IMPORTED_MODULE_6__.useState)('');
  (0,react__WEBPACK_IMPORTED_MODULE_6__.useEffect)(() => {
    verifyEmail();
  }, []);

  const handleRedirect = () => {
    if (loggedIn) {
      if (useCaseOnboarding) {
        // need info about whether admin or not,
        // and whether admin has already completed
        // first time onboarding. Instead of fetching and orchestrating that here,
        // let the default root component handle it.
        history.push('/');
        return;
      }

      (0,actions_global_actions__WEBPACK_IMPORTED_MODULE_8__/* .redirectUserToDefaultTeam */ .mc)();
      return;
    }

    const newSearchParam = new URLSearchParams(search);
    newSearchParam.set('extra', utils_constants__WEBPACK_IMPORTED_MODULE_17__/* .Constants.SIGNIN_VERIFIED */ .gT.SIGNIN_VERIFIED);
    history.push("/login?".concat(newSearchParam));
  };

  const verifyEmail = async () => {
    const {
      error
    } = await dispatch((0,mattermost_redux_actions_users__WEBPACK_IMPORTED_MODULE_14__/* .verifyUserEmail */ .NH)(token));

    if (error) {
      setVerifyStatus(VerifyStatus.FAILURE);
      setServerError(formatMessage({
        id: 'signup_user_completed.invalid_invite.message',
        defaultMessage: 'Please speak with your Administrator to receive an invitation.'
      }));
      return;
    }

    setVerifyStatus(VerifyStatus.SUCCESS);
    await dispatch((0,mattermost_redux_actions_errors__WEBPACK_IMPORTED_MODULE_13__/* .clearErrors */ .b9)());

    if (!loggedIn) {
      handleRedirect();
      return;
    }

    dispatch((0,mattermost_redux_actions_errors__WEBPACK_IMPORTED_MODULE_13__/* .logError */ .H)({
      message: utils_constants__WEBPACK_IMPORTED_MODULE_17__/* .AnnouncementBarMessages.EMAIL_VERIFIED */ .MN.EMAIL_VERIFIED,
      type: utils_constants__WEBPACK_IMPORTED_MODULE_17__/* .AnnouncementBarTypes.SUCCESS */ .Mw.SUCCESS
    }, true));
    (0,actions_telemetry_actions_jsx__WEBPACK_IMPORTED_MODULE_9__/* .trackEvent */ .L9)('settings', 'verify_email');
    const {
      error: getMeError
    } = await dispatch((0,mattermost_redux_actions_users__WEBPACK_IMPORTED_MODULE_14__/* .getMe */ .jo)());

    if (getMeError) {
      setVerifyStatus(VerifyStatus.FAILURE);
      setServerError(formatMessage({
        id: 'signup_user_completed.failed_update_user_state',
        defaultMessage: 'Please clear your cache and try to log in.'
      }));
      return;
    }

    handleRedirect();
  };

  const handleReturnButtonOnClick = () => history.replace('/');

  return verifyStatus === VerifyStatus.FAILURE ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6__.createElement("div", {
    className: "do-verify-body"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6__.createElement("div", {
    className: "do-verify-body-content"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6__.createElement(components_header_footer_route_content_layouts_column__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    title: formatMessage({
      id: 'signup_user_completed.invalid_invite.title',
      defaultMessage: 'This invite link is invalid'
    }),
    message: serverError,
    SVGElement: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6__.createElement(components_common_svg_images_components_laptop_alert_svg__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z, null),
    extraContent: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6__.createElement("div", {
      className: "do-verify-body-content-button-container"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6__.createElement("button", {
      className: "do-verify-body-content-button-return",
      onClick: handleReturnButtonOnClick
    }, formatMessage({
      id: 'signup_user_completed.return',
      defaultMessage: 'Return to log in'
    })))
  }))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6__.createElement(components_loading_screen__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, null);
};

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (DoVerifyEmail);

/***/ }),

/***/ 71284:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(45697);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var utils_constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(66788);

// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.
// See LICENSE.txt for license information.




const Column = _ref => {
  let {
    title,
    message,
    SVGElement,
    extraContent,
    onEnterKeyDown
  } = _ref;

  const handleOnEnterKeyDown = e => {
    if (onEnterKeyDown && e.key === utils_constants__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KeyCodes.ENTER[0] */ .ZP.KeyCodes.ENTER[0]) {
      onEnterKeyDown(e);
    }
  };

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    className: "content-layout-column",
    onKeyDown: handleOnEnterKeyDown,
    tabIndex: 0
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    className: "content-layout-column-svg"
  }, SVGElement), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h1", {
    className: "content-layout-column-title"
  }, title), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
    className: "content-layout-column-message"
  }, message), extraContent && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    className: "content-layout-column-extra-content"
  }, extraContent));
};

Column.propTypes = {
  title: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().string.isRequired),
  message: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().string.isRequired),
  SVGElement: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().node),
  extraContent: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().node),
  onEnterKeyDown: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().func)
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Column);

/***/ })

}]);
//# sourceMappingURL=355.68f9adcbccdc757ab5c4.js.map